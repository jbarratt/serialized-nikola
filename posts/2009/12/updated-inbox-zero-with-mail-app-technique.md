<!--
.. title: Updated "Inbox Zero with Mail.app" technique
.. date: 2009/12/02 13:37
.. slug: updated-inbox-zero-with-mail-app-technique
.. tags:
.. link:
.. description:
-->


**Update**: I have updated to a new method since writing this -- I now use a [free native Archiving plugin](http://stl.techinno.nl/archive/). More information in my [most recent article](/2010/09/up-up-updated-inbox-zero-with-mail-app-technique/).


Back in March, I wrote about my [technique for implementing Inbox Zero with Mail.app](/2009/03/my-approach-to-inbox-zero-with-mailapp/).

Since then, the world has changed. I've upgraded to Snow Leopard, and Quicksilver has essentially stopped working out for me. (I've been trying to keep it up to date, and sometimes it kind of works, but my confidence levels are really low.) On the other hand, I'm loving me some [Google Quick Search Box](http://code.google.com/p/qsb-mac/) (a new project from the [original creator of Quicksilver](http://www.cultofmac.com/quicksilver-is-sort-of-dead-long-live-google-quick-search-box/6986)). The only feature that I still wanted Quicksilver for was triggers. And until today, I was still running it for trigger support to implement my Inbox Zero trick.

And then triggers broke when I upgraded it. And I'm out.

So here's how to get Inbox Zero magic in Mail.app using only tools native to Snow Leopard.

First, launch Automator and create a new Service workflow.
![Automator Create a new Service Workflow](/images/Automator_select_service.jpg "Automator Create a new Service Workflow")

Select "Utilities" and then drag in "Run Applescript" to the window on the right.

![Automator: Run Applescript](/images/automator-drag-run-applescript.jpg "Automator: Run Applescript")

Fill in your applescript, replacing only the center "comment" block -- leave the other autogenerated lines there.

The core code again, (tweak to fit your accounts and archive mailbox names)

``` applescript
    tell application "Mail"
        set theSelectedMessages to selection
        set myAccount to "zimbra"
        set myMailbox to "Archive"
        repeat with theMessage in theSelectedMessages
            move theMessage to mailbox myMailbox of account myAccount
        end repeat
    end tell
```

It should look something like this:
![Automator: Archive Applescript](/images/automator_archive.jpg "Automator: Archive Applescript")

And that's it! Save it, and give it a name you'll remember. (I chose "Archive Selected Mail.")

Now it's actually in Mail's Menu (under 'Services') and we can use the built in OSX hotkey support to launch it.

Go to the System Preferences Menu, click "Keyboard Shortcuts", and add one for the menu item you created. (It needs to be the same exact name you saved your service as.)

![Keyboard Shortcuts: Archive Mail](/images/Keyboard-Shortcuts-Archive-Mail.jpg "Keyboard Shortcuts: Archive Mail")

Badda bing. Feature complete, and I can (sadly) retire Quicksilver forever. This technique should be extensible to all kinds of other cases when you want to add new features to applications, for access either through the menus or with hot keys.


